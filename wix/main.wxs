<?xml version='1.0' encoding='windows-1252'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>
    <Product
        Id='*'
        Name='BeamMP Panel'
        UpgradeCode='9C5E5B5E-5E5E-4E5E-9E5E-5E5E5E5E5E5E'
        Manufacturer='BeamMP Panel'
        Language='1033'
        Codepage='1252'
        Version='0.1.0'>

        <Package
            Id='*'
            Keywords='Installer'
            Description='BeamMP Panel Installer'
            Manufacturer='BeamMP Panel'
            InstallerVersion='450'
            Languages='1033'
            Compressed='yes'
            InstallScope='perMachine'
            SummaryCodepage='1252'
        />

        <MajorUpgrade
            Schedule='afterInstallInitialize'
            DowngradeErrorMessage='A newer version of [ProductName] is already installed. Setup will now exit.'
        />

        <Media Id='1' Cabinet='media1.cab' EmbedCab='yes' DiskPrompt='CD-ROM #1' />
        <Property Id='DiskPrompt' Value='BeamMP Panel Installation' />

        <Directory Id='TARGETDIR' Name='SourceDir'>
            <Directory Id='ProgramFiles64Folder'>
                <Directory Id='APPLICATIONFOLDER' Name='BeamMP Panel'>
                    <Component Id='MainExecutable' Guid='A1A1A1A1-A1A1-A1A1-A1A1-A1A1A1A1A1A1'>
                        <File
                            Id='BeamMPPanelEXE'
                            Name='beammp-panel.exe'
                            DiskId='1'
                            Source='target\release\beammp-panel.exe'
                            KeyPath='yes'
                        />
                    </Component>
                </Directory>
            </Directory>

            <Directory Id='ProgramMenuFolder'>
                <Directory Id='ApplicationProgramsFolder' Name='BeamMP Panel'>
                    <Component Id='ApplicationShortcut' Guid='B2B2B2B2-B2B2-B2B2-B2B2-B2B2B2B2B2B2'>
                        <Shortcut
                            Id='ApplicationStartMenuShortcut'
                            Name='BeamMP Panel'
                            Description='BeamMP Server Manager'
                            Target='[APPLICATIONFOLDER]beammp-panel.exe'
                            WorkingDirectory='APPLICATIONFOLDER'
                        />
                        <RemoveFolder Id='CleanUpShortCut' Directory='ApplicationProgramsFolder' On='uninstall' />
                        <RegistryValue
                            Root='HKCU'
                            Key='Software\BeamMP\Panel'
                            Name='installed'
                            Type='integer'
                            Value='1'
                            KeyPath='yes'
                        />
                    </Component>
                </Directory>
            </Directory>

            <Directory Id='DesktopFolder' Name='Desktop'>
                <Component Id='DesktopShortcut' Guid='C3C3C3C3-C3C3-C3C3-C3C3-C3C3C3C3C3C3'>
                    <Shortcut
                        Id='ApplicationDesktopShortcut'
                        Name='BeamMP Panel'
                        Description='BeamMP Server Manager'
                        Target='[APPLICATIONFOLDER]beammp-panel.exe'
                        WorkingDirectory='APPLICATIONFOLDER'
                    />
                    <RemoveFolder Id='CleanUpDesktopShortcut' On='uninstall' />
                    <RegistryValue
                        Root='HKCU'
                        Key='Software\BeamMP\Panel'
                        Name='desktop_shortcut'
                        Type='integer'
                        Value='1'
                        KeyPath='yes'
                    />
                </Component>
            </Directory>
        </Directory>

        <Feature
            Id='MainApplication'
            Title='BeamMP Panel'
            Description='BeamMP Panel Application'
            Level='1'
            ConfigurableDirectory='APPLICATIONFOLDER'
            AllowAdvertise='no'
            Display='expand'
            Absent='disallow'>
            <ComponentRef Id='MainExecutable' />
            <ComponentRef Id='ApplicationShortcut' />
            <ComponentRef Id='DesktopShortcut' />
        </Feature>

        <Icon Id='ProductIcon' SourceFile='target\release\beammp-panel.exe' />
        <Property Id='ARPPRODUCTICON' Value='ProductIcon' />
        <Property Id='ARPHELPLINK' Value='https://github.com/yourusername/beammp-panel' />
        <UIRef Id='WixUI_InstallDir' />
        <Property Id='WIXUI_INSTALLDIR' Value='APPLICATIONFOLDER' />
    </Product>
</Wix>

